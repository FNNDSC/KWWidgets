GET_FILENAME_COMPONENT(EXAMPLE_DIR_NAME ${CMAKE_CURRENT_SOURCE_DIR} NAME)
SET(EXAMPLE_TARGET_NAME "KW${EXAMPLE_DIR_NAME}Example")
SET(EXAMPLE_SRCS "${EXAMPLE_TARGET_NAME}.cxx")
SET(EXAMPLE_LIB "${EXAMPLE_TARGET_NAME}Lib")
SET(EXAMPLE_LIB_SRCS "vtk${EXAMPLE_TARGET_NAME}.cxx")

INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR})
VTK_WRAP_TCL3(${EXAMPLE_LIB} EXAMPLE_LIB_TCL_SRCS ${EXAMPLE_LIB_SRCS} "")
ADD_LIBRARY(${EXAMPLE_LIB} STATIC ${EXAMPLE_LIB_TCL_SRCS} ${EXAMPLE_LIB_SRCS})

IF(WIN32)
  SET(RES_FILE "${CMAKE_CURRENT_BINARY_DIR}/${EXAMPLE_TARGET_NAME}.rc")
  SET(KWWidgets_RESOURCE_APPLICATION_NAME "${EXAMPLE_TARGET_NAME}")
  SET(KWWidgets_RESOURCE_FILE_NAME "${EXAMPLE_TARGET_NAME}")
  CONFIGURE_FILE(${KWWidgets_RESOURCES_DIR}/KWWidgets.rc.in ${RES_FILE})
ENDIF(WIN32)

INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR})
CONFIGURE_FILE(
  ${KWWidgets_TEMPLATES_DIR}/vtkKWWidgetsPaths.h.in 
  ${CMAKE_CURRENT_BINARY_DIR}/vtkKWWidgetsPaths.h)

ADD_EXECUTABLE(${EXAMPLE_TARGET_NAME} WIN32 ${EXAMPLE_SRCS} ${RES_FILE})
TARGET_LINK_LIBRARIES(${EXAMPLE_TARGET_NAME} ${KWWidgets_LIBRARIES} ${EXAMPLE_LIB})

IF(BUILD_EXAMPLES)
  INSTALL_TARGETS(${KWWidgets_INSTALL_BIN_DIR} ${EXAMPLE_TARGET_NAME})
  INSTALL_FILES("${KWWidgets_INSTALL_DATA_DIR}/Examples/Cxx/${EXAMPLE_DIR_NAME}" ${EXAMPLE_TARGET_NAME})
ENDIF(BUILD_EXAMPLES)

IF(BUILD_TESTING)
  ADD_TEST(Test${EXAMPLE_TARGET_NAME} ${EXECUTABLE_OUTPUT_PATH}/${EXAMPLE_TARGET_NAME} --test)
ENDIF(BUILD_TESTING)

